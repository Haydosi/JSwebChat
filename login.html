<html>

<head>
    <script>
        var users = {}
        // var storedUsername = "admin"
        // var storedPassword = "pass"
        // var users = {
        //     admin: "pass",
        //     beta: "tester",
        //     personal: "yeet"
        // }
        function getUsersLocal() {
            return Promise.resolve(JSON.parse(localStorage.getItem('localStorage3')) || [])
        }
        function getUsersRemote() {
            return fetch("https://haydenivins.s3-ap-southeast-2.amazonaws.com/jswebchat.json")
                .then(response => response.json())
        }
        function startUp() {
            var loggedIn = localStorage.getItem('localStorage2')
            if (loggedIn == "1") {
                window.location = "index.html"
            } else {
                getUsersRemote().then(response => {
                    users = response
                });
            }
        }
        function login() {
            var username = document.querySelector("#username").value
            var password = document.querySelector("#password").value
            var status = document.querySelector("#status")
            console.log('users', users)
            if (users[username].password == password) {
                status.innerHTML = "login successful"
                console.log("succeed")
                setTimeout(redirect, 1000)
            } else {
                status.innerHTML = "login failed"
                console.log("fail")
            }
            // if (username == storedUsername) {
            //     if (password == storedPassword) {
            // status.innerHTML = "login successful"
            // console.log("succeed")
            // setTimeout(redirect, 1000)
            //     } else {
            //         status.innerHTML = "login failed"
            //         console.log("fail")
            //     }
            // } else {
            //     status.innerHTML = "login failed"
            //     console.log("fail")
            // }
        }
        function redirect() {
            var loggedIn = "1"
            localStorage.setItem("localStorage2", loggedIn)
            window.location = "index.html"
        }
        function redirect2() {
            window.location = "signUp.html"
        }
    </script>
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/bulma/0.7.5/css/bulma.min.css">
</head>

<body onLoad="startUp()">
  <div class="hero-body">
        <div class="container has-text-centered">
                <p>Please Login<p>
                        <p>username:<input id="username" type=text></p>
                        <p>password:<input id="password" type=text></p>
                        <p><button onClick="login()">LOGIN</button></p>
                        <div id="status"></div>
                        <p>Don't have an account?</p>
                        <p><button onClick="redirect2()">Sign Up</button></p>
        </div>
      </div>
</body>

</html>